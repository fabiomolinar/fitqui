<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="fitqui-controls.html">

<dom-module id="fitqui-trainer">
  <template>
    <link rel="stylesheet" type="text/css" href="../../css/fitqui-app/fitqui-content/fitqui-trainer.css" inline>

    <div class="flex-row">
      <div class="programa">
        <h2 id="nome"></h2>
        <h3 id="musculosPrimarios"></h3>
        <h4 id="musculosSecundarios"></h4>
        <p id="repeticoes"></p>
        <p id="duracao"></p>
        <img id="gif" src="" alt="">
        <p><a id="youtube" href="#"></a></p>
      </div>
      <!-- prop1 = container para propaganda 1 -->
      <div class="prop1">

      </div>
    </div>
    <fitqui-controls id="controle"
      atual-exercicios={{posicao}}
      total-exercicios={{programa.length}}>
    </fitqui-controls>

  </template>
  <script>
    Polymer({
      is: 'fitqui-trainer',
      properties: {
        programa: {
          type: Array,
          value: [],
          observer: 'atualizarTela'
        },
        route: {
          type: Object
        },
        posicao: {
          type: Number,
          computed: 'computePosicao(route)',
          observer: 'atualizarTela'
        }
      },
      computePosicao: function(route){
        var path = route.path;
        var posicao = 1;
        var primeiro = path.indexOf("/");
        if (primeiro > -1){
          var ultimo = path.lastIndexOf("/");
          if (primeiro === ultimo){
            posicao = parseInt(path.substring(primeiro + 1,path.length));
          } else {
            posicao = parseInt(path.substring(primeiro + 1, ultimo + 1));
          }
        }
        if (!isNaN(posicao)){
          return posicao;
        } else {
          return 1;
        }
      },
      atualizarTela: function(){
        try {
          this.$.nome.textContent = this.programa[this.posicao].nome;
          this.$.musculosPrimarios.textContent = this.programa[this.posicao].musculosPrimarios.toString();
          this.$.musculosSecundarios.textContent = this.programa[this.posicao].musculosSecundarios.toString();
          this.$.repeticoes.textContent = this.programa[this.posicao].repeticoes.toString();
          this.$.duracao.textContent = this.programa[this.posicao].duracao.toString();
          this.$.gif.src = this.programa[this.posicao].gif;
          this.$.youtube.href = this.programa[this.posicao].youtube;
        } catch (e) {
          if (_fitqui.devMode()){
            console.log(e.name + ": " + e.message);
          }
        } finally {

        }
      }
    });
  </script>
</dom-module>
